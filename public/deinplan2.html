<!DOCTYPE html>
<html lang="de">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-17806525009"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'AW-17806525009');
</script>
<!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '864109602683515');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=864109602683515&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "ufxcf43805");
</script>
<script src="https://js.stripe.com/v3/"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WauWerk - Dein 2-Wochen-Schnellstart</title>
    <link rel="icon" type="image/png" href="favconHund.png">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --text-dark: #2C2C2E; --text-medium: #6B6B6B; --text-light: #999999;
            --background: #FFFFFF; --white: #FFFFFF; --border-light: #E8E4DF;
            --light-brown: #D4B996; --warm-brown: #C4A576; --dark-brown: #8B7355;
            --accent-red: #E8A598; --accent-green: #A8C5A0; --border-radius: 12px;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--background); color: var(--text-dark); line-height: 1.5; }
        .header { background: var(--white); padding: 16px 20px; text-align: center; border-bottom: 1px solid var(--border-light); }
        .logo { display: inline-flex; align-items: center; gap: 10px; text-decoration: none; }
        .logo-image { width: 36px; height: 36px; border-radius: 8px; }
        .logo-text { font-size: 24px; font-weight: 800; color: var(--text-dark); }
        .timer-bar { background: var(--dark-brown); color: var(--white); padding: 12px 20px; text-align: center; font-size: 16px; }
        .timer-bar span { font-weight: 700; color: #F5E6D3; }
        .hero-section { background: linear-gradient(180deg, #F5EDE3 0%, #FFFFFF 100%); padding: 30px 20px 40px; }
        .comparison-container { max-width: 600px; margin: 0 auto; display: flex; gap: 15px; position: relative; }
        .comparison-side { flex: 1; text-align: center; }
        .comparison-badge { display: inline-block; padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; margin-bottom: 15px; }
        .badge-now { background: var(--white); color: var(--text-dark); border: 1px solid var(--border-light); }
        .badge-goal { background: var(--warm-brown); color: var(--white); }
        .comparison-image { width: 100%; height: 320px; background: var(--border-light); border-radius: var(--border-radius); margin-bottom: 20px; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }
        .image-now { background: linear-gradient(135deg, #F0DED0 0%, #F5E8DD 100%); }
        .image-goal { background: linear-gradient(135deg, #E8DCCC 0%, #F0E6DA 100%); }
        .comparison-arrows { position: absolute; left: 50%; top: 45%; transform: translate(-50%, -50%); display: flex; flex-direction: column; align-items: center; gap: 2px; font-size: 26px; z-index: 10; }
        .comparison-arrows span { color: var(--warm-brown); opacity: 0.4; animation: lightUp 2s ease-in-out infinite; }
        .comparison-arrows span:nth-child(1) { animation-delay: 0s; }
        .comparison-arrows span:nth-child(2) { animation-delay: 0.15s; }
        .comparison-arrows span:nth-child(3) { animation-delay: 0.3s; }
        .comparison-arrows span:nth-child(4) { animation-delay: 0.45s; }
        .comparison-arrows span:nth-child(5) { animation-delay: 0.6s; }
        .comparison-arrows span:nth-child(6) { animation-delay: 0.75s; }
        @keyframes lightUp { 0%, 100% { opacity: 0.4; text-shadow: none; } 50% { opacity: 1; text-shadow: 0 0 15px rgba(196, 165, 118, 0.9), 0 0 25px rgba(196, 165, 118, 0.6); } }
        .stat-box { background: var(--white); border-radius: var(--border-radius); padding: 15px; margin-bottom: 10px; }
        .stat-label { font-size: 13px; font-weight: 600; color: var(--text-dark); margin-bottom: 4px; }
        .stat-value { font-size: 14px; color: var(--text-medium); }
        .stat-bar { display: flex; gap: 6px; margin-top: 8px; padding: 4px; border: 1px solid var(--border-light); border-radius: 6px; background: var(--white); }
        .stat-bar-segment { flex: 1; height: 6px; border-radius: 3px; background: var(--border-light); }
        .stat-bar-segment.active-red { background: var(--accent-red); }
        .stat-bar-segment.active-green { background: #4CAF50; }
        .container { max-width: 600px; margin: 0 auto; padding: 30px 20px; }
        .title-section { text-align: center; margin-bottom: 30px; }
        .main-title { font-size: 28px; font-weight: 800; color: var(--text-dark); margin-bottom: 20px; line-height: 1.2; }
        .main-title .highlight { color: var(--warm-brown); }
        .goal-badges { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .goal-badge { display: flex; align-items: center; gap: 10px; background: var(--white); padding: 12px 18px; border-radius: var(--border-radius); border: 1px solid var(--border-light); }
        .goal-badge-icon { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .icon-blue { background: #F5EDE3; color: var(--dark-brown); }
        .icon-orange { background: #F5E6D8; color: var(--warm-brown); }
        .goal-badge-text { text-align: left; }
        .goal-badge-label { font-size: 11px; color: var(--text-light); text-transform: uppercase; }
        .goal-badge-value { font-size: 14px; font-weight: 600; color: var(--text-dark); }
        .motivation-text { text-align: center; margin-bottom: 25px; padding: 20px; background: linear-gradient(135deg, #FAF6F1 0%, var(--white) 100%); border-radius: var(--border-radius); border: 1px solid var(--border-light); }
        .motivation-text p { font-size: 16px; color: var(--text-medium); line-height: 1.6; margin-bottom: 10px; }
        .motivation-text .problem-highlight { color: var(--warm-brown); font-weight: 600; }
        .motivation-question { font-size: 18px !important; font-weight: 600 !important; color: var(--text-dark) !important; margin-bottom: 0 !important; }
        .pricing-section { margin-bottom: 30px; }
        .pricing-card { background: linear-gradient(135deg, #FFFBF5 0%, #FFF8EE 100%); border: 2px solid var(--warm-brown); border-radius: var(--border-radius); padding: 25px; text-align: center; position: relative; }
        .pricing-badge { background: linear-gradient(135deg, #e74c3c, #c0392b); color: var(--white); padding: 6px 16px; border-radius: 20px; font-size: 12px; font-weight: 700; display: inline-block; margin-bottom: 15px; }
        .pricing-name { font-size: 20px; font-weight: 700; color: var(--text-dark); margin-bottom: 10px; }
        .pricing-price-row { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 10px; }
        .price-old { font-size: 24px; color: var(--text-light); text-decoration: line-through; }
        .price-new { font-size: 48px; font-weight: 800; color: var(--text-dark); }
        .pricing-info { font-size: 14px; color: var(--text-medium); }
        .cta-button { width: 100%; background: var(--warm-brown); color: var(--white); border: none; border-radius: var(--border-radius); padding: 18px 20px; font-size: 18px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 15px; line-height: 1.3; display: flex; flex-direction: column; align-items: center; gap: 2px; }
        .cta-subtext { font-size: 11px; font-weight: 500; opacity: 0.9; text-transform: none; letter-spacing: 0; }
        .cta-button:hover { background: var(--dark-brown); transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 115, 85, 0.4); }
        .cta-button.glow { animation: glow 2s ease-in-out infinite; }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 5px rgba(196, 165, 118, 0.4), 0 0 15px rgba(196, 165, 118, 0.2); } 50% { box-shadow: 0 0 20px rgba(196, 165, 118, 0.6), 0 0 40px rgba(196, 165, 118, 0.4); } }
        .disclaimer { background: #F9F7F5; border-radius: var(--border-radius); padding: 15px 20px; margin-bottom: 20px; font-size: 13px; color: var(--text-medium); line-height: 1.6; text-align: center; }
        .disclaimer a { color: var(--warm-brown); text-decoration: none; font-weight: 600; }
        .guarantee { display: flex; align-items: center; justify-content: center; gap: 10px; color: var(--text-dark); font-size: 16px; font-weight: 600; margin-bottom: 30px; padding: 14px 20px; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border: 1px solid #86efac; border-radius: var(--border-radius); }
        .guarantee svg { width: 24px; height: 24px; fill: #16a34a; }
        .payment-logos { display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 15px; flex-wrap: nowrap; }
        .payment-logos img { height: 24px; width: auto; opacity: 0.7; transition: opacity 0.2s ease; border-radius: 6px; }
        .payment-logos img:hover { opacity: 1; }
        .section-header { text-align: center; margin-bottom: 25px; }
        .section-title { font-size: 20px; font-weight: 700; color: var(--text-dark); margin-bottom: 5px; }
        .section-subtitle { font-size: 14px; color: var(--warm-brown); }
        .testimonial-card { background: var(--white); border-radius: var(--border-radius); padding: 20px; margin-bottom: 15px; border: 1px solid var(--border-light); }
        .testimonial-image-single { width: 100%; height: auto; aspect-ratio: 1875 / 1563; background: var(--border-light); border-radius: 8px; margin-bottom: 15px; overflow: hidden; }
        .testimonial-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .testimonial-name { font-weight: 700; color: var(--text-dark); }
        .testimonial-problem { font-size: 13px; color: var(--text-light); }
        .testimonial-problem span { color: var(--warm-brown); font-weight: 600; }
        .testimonial-text { font-size: 14px; color: var(--text-medium); line-height: 1.6; }
        .benefits-box { background: var(--white); border-radius: var(--border-radius); padding: 25px; margin-bottom: 25px; border: 1px solid var(--border-light); }
        .benefits-title { font-size: 20px; font-weight: 700; color: var(--text-dark); margin-bottom: 20px; text-align: center; }
        .benefits-list { list-style: none; padding: 0; margin: 0; }
        .benefits-list li { padding: 10px 0; font-size: 15px; color: var(--text-dark); border-bottom: 1px solid var(--border-light); }
        .benefits-list li:last-child { border-bottom: none; }
        .trustpilot-slider { margin-bottom: 30px; overflow: hidden; }
        .trustpilot-track { display: flex; transition: transform 0.4s ease; }
        .trustpilot-review { min-width: 100%; text-align: center; padding: 20px; background: var(--white); border-radius: var(--border-radius); border: 1px solid var(--border-light); }
        .trustpilot-stars { display: flex; gap: 2px; margin-bottom: 12px; justify-content: center; }
        .tp-star { width: 22px; height: 22px; background: #00B67A; color: white; font-size: 14px; display: flex; align-items: center; justify-content: center; }
        .trustpilot-text { font-size: 15px; color: var(--text-dark); margin-bottom: 10px; font-style: italic; }
        .trustpilot-name { font-size: 13px; color: var(--text-medium); font-weight: 600; }
        .trustpilot-dots { display: flex; justify-content: center; gap: 8px; margin-top: 15px; }
        .tp-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--border-light); cursor: pointer; }
        .tp-dot.active { background: var(--warm-brown); }
        .guarantee-box { background: var(--white); border: 2px solid var(--light-brown); border-radius: var(--border-radius); padding: 25px; text-align: center; margin-bottom: 30px; }
        .guarantee-title { font-size: 20px; font-weight: 700; color: var(--text-dark); margin-bottom: 12px; }
        .guarantee-text { font-size: 14px; color: var(--text-medium); line-height: 1.6; margin-bottom: 15px; }
        .guarantee-badge { display: inline-flex; align-items: center; gap: 8px; color: var(--warm-brown); }
        .guarantee-badge svg { width: 40px; height: 40px; fill: var(--warm-brown); }
        .faq-section { background: var(--white); border-radius: var(--border-radius); padding: 25px; margin-bottom: 30px; }
        .faq-title { font-size: 20px; font-weight: 700; color: var(--text-dark); text-align: center; margin-bottom: 20px; }
        .faq-item { margin-bottom: 20px; }
        .faq-item:last-child { margin-bottom: 0; }
        .faq-question { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 8px; }
        .faq-icon { width: 24px; height: 24px; background: var(--warm-brown); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .faq-icon svg { width: 14px; height: 14px; fill: var(--white); }
        .faq-question-text { font-size: 15px; font-weight: 600; color: var(--text-dark); }
        .faq-answer { font-size: 14px; color: var(--text-medium); line-height: 1.6; padding-left: 36px; }
        .footer { text-align: center; padding: 20px; color: var(--text-light); font-size: 12px; }
        .footer a { color: var(--text-light); text-decoration: underline; }
        .upgrade-hint { background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border: 1px solid #bae6fd; border-radius: var(--border-radius); padding: 15px; margin-bottom: 25px; text-align: center; }
        .upgrade-hint-icon { font-size: 20px; margin-bottom: 5px; }
        .upgrade-hint-text { font-size: 14px; color: #0369a1; }
        .upgrade-hint-text strong { color: #0c4a6e; }
        .checkout-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(44, 44, 46, 0.85); z-index: 10000; justify-content: center; align-items: center; backdrop-filter: blur(8px); overflow: hidden; touch-action: none; }
        .checkout-overlay.active { display: flex; }
        .checkout-popup { background: var(--white); border-radius: 20px; max-width: 420px; width: calc(100% - 40px); max-height: 70%; overflow-y: auto; position: relative; animation: popupIn 0.3s ease-out; box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25); margin-top: 60px; }
        @keyframes popupIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .checkout-header { padding: 14px 16px 10px; border-bottom: 1px solid var(--border-light); position: relative; background: linear-gradient(180deg, #FAF7F4 0%, var(--white) 100%); border-radius: 20px 20px 0 0; }
        .checkout-close { position: absolute; top: 14px; left: 14px; background: var(--white); border: 1px solid var(--border-light); width: 32px; height: 32px; border-radius: 50%; font-size: 18px; color: var(--text-medium); cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .checkout-title { text-align: center; font-size: 18px; font-weight: 700; color: var(--text-dark); }
        .checkout-title span { color: var(--warm-brown); }
        .checkout-body { padding: 12px 16px 16px; }
        .checkout-plan-card { display: flex; align-items: center; gap: 10px; padding: 10px; background: linear-gradient(135deg, #FAF7F4 0%, #F5F0EB 100%); border-radius: 10px; margin-bottom: 12px; border: 1px solid var(--border-light); }
        .checkout-plan-image { width: 42px; height: 42px; background: linear-gradient(135deg, var(--warm-brown), var(--dark-brown)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .checkout-plan-info { flex: 1; }
        .checkout-plan-name { font-size: 14px; font-weight: 700; color: var(--text-dark); margin-bottom: 2px; }
        .checkout-plan-duration { font-size: 13px; color: var(--warm-brown); font-weight: 500; }
        .checkout-plan-price-box { text-align: right; }
        .checkout-plan-price { font-size: 20px; font-weight: 800; color: var(--text-dark); }
        .checkout-plan-access { font-size: 11px; color: var(--text-light); font-weight: 500; }
        .checkout-step-email { text-align: center; }
        .checkout-step-email.hidden { display: none; }
        .checkout-email-icon { font-size: 48px; margin-bottom: 15px; }
        .checkout-email-title { font-size: 18px; font-weight: 700; color: var(--text-dark); margin-bottom: 8px; }
        .checkout-email-subtitle { font-size: 14px; color: var(--text-medium); margin-bottom: 20px; }
        .checkout-email-input { width: 100%; padding: 14px 16px; border: 2px solid var(--border-light); border-radius: 10px; font-size: 16px; margin-bottom: 12px; }
        .checkout-email-input:focus { outline: none; border-color: var(--warm-brown); }
        .checkout-email-btn { width: 100%; padding: 14px; background: linear-gradient(135deg, var(--warm-brown), var(--dark-brown)); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 700; cursor: pointer; margin-bottom: 15px; }
        .checkout-email-privacy { font-size: 11px; color: var(--text-light); }
        .checkout-trust-badge { display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 16px; padding: 10px; background: #f8f8f8; border-radius: 8px; }
        .trust-stars { display: flex; gap: 2px; }
        .trust-star { width: 20px; height: 20px; background: #00b67a; display: flex; align-items: center; justify-content: center; }
        .trust-star svg { width: 12px; height: 12px; fill: white; }
        .trust-text { font-size: 12px; color: var(--text-dark); font-weight: 500; }
        .trust-text strong { color: #00b67a; }
        .checkout-features-compact { background: #f8f8f8; border-radius: 8px; padding: 8px 10px; margin-bottom: 10px; }
        .checkout-feature-row { font-size: 12px; color: var(--text-dark); padding: 3px 0; }
        .checkout-feature-row span { color: var(--warm-brown); font-weight: 600; }
        .checkout-guarantee-compact { text-align: center; font-size: 11px; color: #166534; font-weight: 600; padding: 6px; background: #f0fdf4; border-radius: 6px; margin-bottom: 10px; }
        .checkout-continue-btn { width: 100%; padding: 12px; background: linear-gradient(135deg, var(--warm-brown), var(--dark-brown)); color: white; border: none; border-radius: 10px; font-size: 14px; font-weight: 700; cursor: pointer; text-transform: uppercase; letter-spacing: 0.5px; box-shadow: 0 4px 15px rgba(196, 165, 118, 0.4); }
        .checkout-step-2 { display: none; }
        .checkout-step-2.active { display: block; }
        .checkout-step-1.hidden { display: none; }
        .stripe-element-container { padding: 18px; border: 2px solid var(--border-light); border-radius: 14px; margin-bottom: 18px; background: var(--white); }
        #payment-element { min-height: 100px; }
        .checkout-pay-btn { width: 100%; padding: 16px; background: linear-gradient(135deg, var(--warm-brown), var(--dark-brown)); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 15px rgba(196, 165, 118, 0.4); }
        .checkout-pay-btn:disabled { background: #ccc; cursor: not-allowed; }
        .checkout-pay-btn .spinner { width: 20px; height: 20px; border: 2px solid rgba(255,255,255,0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .payment-icons { display: flex; justify-content: center; align-items: center; gap: 12px; margin-top: 20px; padding: 12px; background: #FAFAFA; border-radius: 10px; }
        .payment-icons img { height: 20px; opacity: 0.7; }
        .checkout-back { display: block; width: 100%; background: none; border: none; color: var(--text-medium); font-size: 14px; cursor: pointer; margin-top: 18px; text-align: center; }
        .checkout-error { background: #FEF2F2; color: #DC2626; padding: 14px 16px; border-radius: 10px; margin-bottom: 18px; font-size: 14px; display: none; border: 1px solid #FECACA; }
        .checkout-error.visible { display: block; }
        @media (max-width: 480px) {
            .comparison-container { flex-direction: row; gap: 10px; }
            .comparison-image { height: 200px; }
            .comparison-arrows { display: none; }
            .main-title { font-size: 24px; }
            .goal-badges { flex-direction: column; align-items: center; }
        }
    </style>
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init','864109602683515');fbq('track','PageView');
    </script>
    <script>(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window,document,"clarity","script","ufxcf43805");</script>
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <header class="header"><div class="logo"><img src="logo.png" alt="WauWerk Logo" class="logo-image"><span class="logo-text">Mein WauWerk</span></div></header>
    <div class="timer-bar">Angebot endet in: <span id="timer">23:59:59</span></div>
    <section class="hero-section">
        <div class="comparison-container">
            <div class="comparison-side">
                <span class="comparison-badge badge-now">Jetzt</span>
                <div class="comparison-image image-now"><img src="Vorher.png" alt="Vorher" style="width:100%;height:100%;object-fit:cover;"></div>
                <div class="stat-box"><div class="stat-label"><span id="dogName1">Dein Hund</span> ‚Äì <span id="problemLabel1">Gehorsam</span></div><div class="stat-value" id="problemValue1">Niedrig</div><div class="stat-bar"><div class="stat-bar-segment active-red"></div><div class="stat-bar-segment"></div><div class="stat-bar-segment"></div></div></div>
                <div class="stat-box"><div class="stat-label">Trainingslevel</div><div class="stat-value">Anf√§nger</div></div>
            </div>
            <div class="comparison-arrows"><span>‚Ä∫‚Ä∫</span><span>‚Ä∫‚Ä∫</span><span>‚Ä∫‚Ä∫</span><span>‚Ä∫‚Ä∫</span><span>‚Ä∫‚Ä∫</span><span>‚Ä∫‚Ä∫</span></div>
            <div class="comparison-side">
                <span class="comparison-badge badge-goal">In 2 Wochen</span>
                <div class="comparison-image image-goal"><img src="Nachher.png" alt="Nachher" style="width:100%;height:100%;object-fit:cover;"></div>
                <div class="stat-box"><div class="stat-label"><span id="dogName2">Dein Hund</span> ‚Äì <span id="problemLabel2">Gehorsam</span></div><div class="stat-value" id="problemValue2">Besser</div><div class="stat-bar"><div class="stat-bar-segment active-green"></div><div class="stat-bar-segment active-green"></div><div class="stat-bar-segment"></div></div></div>
                <div class="stat-box"><div class="stat-label">Trainingslevel</div><div class="stat-value">Einsteiger+</div></div>
            </div>
        </div>
    </section>
    <div class="container">
        <div class="title-section">
            <h1 class="main-title">Wir verstehen ‚Äì <span class="highlight">‚Ç¨30 ist viel Geld</span> f√ºr etwas, das du noch nicht kennst.</h1>
            <div class="goal-badges">
                <div class="goal-badge"><div class="goal-badge-icon icon-blue">üéØ</div><div class="goal-badge-text"><div class="goal-badge-label">Dein Ziel</div><div class="goal-badge-value" id="userGoal">Erste Erfolge sehen</div></div></div>
                <div class="goal-badge"><div class="goal-badge-icon icon-orange">‚ö†Ô∏è</div><div class="goal-badge-text"><div class="goal-badge-label">Problem</div><div class="goal-badge-value" id="userProblem">Verhaltensproblem</div></div></div>
            </div>
        </div>
        <div class="motivation-text">
            <p>Deshalb haben wir den <strong>2-Wochen-Schnellstart</strong> f√ºr <span id="dogNamePlan">deinen Hund</span> erstellt.</p>
            <p>Die wichtigsten √úbungen, die <strong>80% des Problems l√∂sen.</strong> F√ºr nur ‚Ç¨9,99.</p>
            <p class="motivation-question">Wenn du nach 14 Tagen keine Ver√§nderung siehst ‚Äì <span class="problem-highlight">Geld zur√ºck.</span></p>
        </div>
        <div class="pricing-section">
            <div class="pricing-card">
                <span class="pricing-badge">‚ö° NUR HEUTE</span>
                <div class="pricing-name">2-Wochen-Schnellstart f√ºr <span id="dogName3">deinen Hund</span></div>
                <div class="pricing-price-row">
                    <span class="price-old">‚Ç¨29,99</span>
                    <span class="price-new">‚Ç¨9,99</span>
                </div>
                <div class="pricing-info">L√∂st 80% des Problems ‚Ä¢ Die wichtigsten 5 √úbungen</div>
            </div>
        </div>
        <div class="disclaimer">‚úì <strong style="color: var(--warm-brown);">Einmalzahlung</strong> ‚Ä¢ <strong style="color: var(--warm-brown);">Kein Abo</strong> ‚Ä¢ 14 Tage Geld-zur√ºck-Garantie ‚Ä¢ <a href="agb.html">AGB</a></div>
        <button class="cta-button glow" onclick="getMyPlan()">
            Schnellstart freischalten
            <span class="cta-subtext">Sicher bezahlen & sofort starten</span>
        </button>
        <div class="payment-logos"><img src="sepa-logo.png" alt="SEPA"><img src="paypal-logo.png" alt="PayPal"><img src="visa-logo.png" alt="Visa"><img src="klarna-logo.png" alt="Klarna"><img src="mastercard-logo.png" alt="Mastercard"><img src="applepay.png" alt="Apple Pay"><img src="googlepay.png" alt="Google Pay"></div>
        <div class="guarantee"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/></svg>14-Tage Geld-zur√ºck-Garantie</div>
        <div class="upgrade-hint">
            <div class="upgrade-hint-icon">üí°</div>
            <div class="upgrade-hint-text">80% reichen dir nicht? Upgrade jederzeit auf den vollen Plan ‚Äì <strong>du zahlst nur die Differenz.</strong></div>
        </div>
        <div class="benefits-box"><h2 class="benefits-title">So l√∂st du 80% von <span id="userProblemBenefit">dem Problem</span>:</h2><ul class="benefits-list"><li>‚úì Du verstehst endlich, <strong>warum</strong> <span id="dogName4">dein Hund</span> sich so verh√§lt</li><li>‚úì Die ersten Spazierg√§nge werden <strong>deutlich entspannter</strong></li><li>‚úì Du hast einen klaren Plan ‚Äì <strong>kein R√§tselraten</strong> mehr</li><li>‚úì Nur <strong>10 Minuten t√§glich</strong> ‚Äì passt in jeden Alltag</li><li>‚úì Die <strong>5 wichtigsten √úbungen</strong> f√ºr schnelle Erfolge</li></ul></div>
        <div class="testimonials-section">
            <div class="section-header"><h2 class="section-title">Sie waren auch skeptisch...</h2></div>
            <div class="testimonial-card"><div class="testimonial-image-single"><img src="Testimonial1.png" alt="Bella" style="width:100%;height:100%;object-fit:cover;border-radius:8px;"></div><div class="testimonial-header"><div><div class="testimonial-name">Sandra & Bella</div><div class="testimonial-problem">Problem: <span>Leinenziehen</span></div></div></div><p class="testimonial-text">"Nach 10 Tagen war das Ziehen zu 80% weg. F√ºr ‚Ç¨10! Ich hab dann den vollen Plan geholt, weil ich wissen wollte, wie ich die letzten 20% auch noch schaffe."</p></div>
        </div>
        <div class="trustpilot-slider"><div class="trustpilot-track" id="tpTrack"><div class="trustpilot-review"><div class="trustpilot-stars"><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span></div><p class="trustpilot-text">"80% besser nach 2 Wochen ‚Äì f√ºr ‚Ç¨10 unschlagbar."</p><p class="trustpilot-name">Sandra M.</p></div><div class="trustpilot-review"><div class="trustpilot-stars"><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span></div><p class="trustpilot-text">"Perfekter Einstieg. Hab danach den vollen Plan geholt."</p><p class="trustpilot-name">Thomas K.</p></div><div class="trustpilot-review"><div class="trustpilot-stars"><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span><span class="tp-star">‚òÖ</span></div><p class="trustpilot-text">"Endlich ein Angebot ohne leere Versprechen. Ehrlich und effektiv."</p><p class="trustpilot-name">Julia R.</p></div></div><div class="trustpilot-dots"><span class="tp-dot active" data-index="0"></span><span class="tp-dot" data-index="1"></span><span class="tp-dot" data-index="2"></span></div></div>
        <div class="guarantee-box"><h3 class="guarantee-title">Kein Risiko f√ºr dich</h3><p class="guarantee-text">Wenn du nach 14 Tagen keine Verbesserung bei <span id="dogName5">deinem Hund</span> siehst ‚Äì schreib uns eine kurze Mail und du bekommst jeden Cent zur√ºck. Ohne Wenn und Aber.</p><div class="guarantee-badge"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/></svg></div></div>
        <div class="faq-section"><h2 class="faq-title">Vielleicht fragst du dich...</h2><div class="faq-item"><div class="faq-question"><div class="faq-icon"><svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div><span class="faq-question-text">"Funktioniert das auch bei meinem Hund?"</span></div><p class="faq-answer">Ja. Der Plan wird personalisiert f√ºr <span id="dogName6">deinen Hund</span> und sein spezifisches Problem erstellt. Falls es trotzdem nicht klappt ‚Äì Geld zur√ºck.</p></div><div class="faq-item"><div class="faq-question"><div class="faq-icon"><svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div><span class="faq-question-text">"Was ist der Unterschied zum vollen Plan?"</span></div><p class="faq-answer">Der Schnellstart l√∂st <strong>80% des Problems</strong> mit den 5 wichtigsten √úbungen. Der volle Plan geht tiefer: 20+ √úbungen, Bonus-Module und dauerhafte Verhaltens√§nderung. Wenn du mehr willst, zahlst du sp√§ter nur die Differenz.</p></div><div class="faq-item"><div class="faq-question"><div class="faq-icon"><svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div><span class="faq-question-text">"Ich hab schon so viel ausprobiert..."</span></div><p class="faq-answer">Verstehen wir. Aber f√ºr ‚Ç¨9,99 riskierst du nichts. Im schlimmsten Fall bekommst du dein Geld zur√ºck. Im besten Fall hast du endlich eine Methode, die funktioniert.</p></div></div>
        <button class="cta-button glow" onclick="getMyPlan()">
            Schnellstart freischalten
            <span class="cta-subtext">Sicher bezahlen & sofort starten</span>
        </button>
    </div>
    <footer class="footer"><p>¬© 2025 Mein WauWerk. Alle Rechte vorbehalten.</p><p><a href="datenschutz.html">Datenschutz</a> ‚Ä¢ <a href="impressum.html">Impressum</a> ‚Ä¢ <a href="agb.html">AGB</a></p></footer>
    <div class="checkout-overlay" id="checkoutPopup"><div class="checkout-popup"><div class="checkout-header"><button class="checkout-close" onclick="closeCheckoutPopup()">√ó</button><h2 class="checkout-title">Schnellstart f√ºr <span id="checkoutDogName">deinen Hund</span></h2></div><div class="checkout-body">
<!-- Step 2: Payment (direkt sichtbar) -->
<div class="checkout-step-2 active" id="checkoutStep2">
<div class="checkout-plan-card" style="margin-bottom:12px;"><div class="checkout-plan-image">üêï</div><div class="checkout-plan-info"><div class="checkout-plan-name">2-Wochen-Schnellstart</div><div class="checkout-plan-duration">14-Tage-Plan</div></div><div class="checkout-plan-price-box"><div class="checkout-plan-price">‚Ç¨9,99</div><div class="checkout-plan-access">Sofort-Zugang</div></div></div>
<div class="checkout-features-compact" style="margin-bottom:12px;"><div class="checkout-feature-row">‚úì L√∂st <strong>80%</strong> von <span id="checkoutDogProblem">dem Problem</span></div><div class="checkout-feature-row">‚úì Die 5 wichtigsten √úbungen</div><div class="checkout-feature-row">‚úì Nur 10 Min. t√§glich</div></div>
<div class="checkout-guarantee-compact" style="margin-bottom:15px;">üõ°Ô∏è 14 Tage Geld-zur√ºck-Garantie</div>
<h3 style="text-align:center;margin-bottom:15px;font-size:16px;color:#6B6B6B;">Zahlungsmethode w√§hlen</h3>
<div class="checkout-error" id="checkoutError"></div>
<div class="stripe-element-container"><div id="payment-element"></div></div>
<button class="checkout-pay-btn" id="checkoutPayBtn" onclick="submitPayment()">üîí Jetzt ‚Ç¨9,99 bezahlen</button>
<div class="payment-icons"><img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa"><img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg" alt="Mastercard"><img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal"><img src="klarna-logo.png" alt="Klarna"></div>
<button class="checkout-back" onclick="closeCheckoutPopup()">‚Üê Zur√ºck</button>
</div>
<!-- Hidden elements for JS compatibility -->
<div class="hidden" id="checkoutStepEmail"></div>
<div class="hidden" id="checkoutStep1"></div>
<span id="checkoutDogName2" class="hidden"></span>
<input type="hidden" id="checkoutEmailInput">
</div></div></div>
<script>
const SUPABASE_URL = 'https://xomsibpyksrzrnixbdwf.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhvbXNpYnB5a3NyenJuaXhiZHdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NjMxMjIsImV4cCI6MjA3MjIzOTEyMn0.ZgCwog94HUHz39lbGMJkFPeZ6c-nL4AMFFTz5AgwnKE';
const STRIPE_PUBLIC_KEY = 'pk_live_51R4LfjAI8IbKLr6RO63Mf5cZmwW8GZCV8fveuqas0sQU8tVtGGISXj1WxQBN5LjUu7IMt0swCgIp8XEFDFZKqgSI00N5iaRkiy';

// ==================== LOAD DATA FROM SUPABASE IF COMING FROM EMAIL ====================
(async function() {
    const urlParams = new URLSearchParams(window.location.search);
    const leadIdFromUrl = urlParams.get('lead_id');
    const emailFromUrl = urlParams.get('email');
    
    // Wenn lead_id ODER email in URL -> aus Supabase laden
    if (leadIdFromUrl || emailFromUrl) {
        console.log('üìß User kam via E-Mail Link, lade Daten aus Supabase...');
        
        // Query bauen - entweder nach ID oder nach Email
        let queryParam = '';
        if (leadIdFromUrl) {
            queryParam = 'id=eq.' + leadIdFromUrl;
        } else if (emailFromUrl) {
            // Email URL-decoden und suchen
            const decodedEmail = decodeURIComponent(emailFromUrl);
            queryParam = 'email=eq.' + encodeURIComponent(decodedEmail);
        }
        
        try {
            const response = await fetch(SUPABASE_URL + '/rest/v1/wauwerk_leads?' + queryParam + '&select=*&order=created_at.desc&limit=1', {
                headers: {
                    'apikey': SUPABASE_ANON_KEY,
                    'Authorization': 'Bearer ' + SUPABASE_ANON_KEY
                }
            });
            
            if (response.ok) {
                const data = await response.json();
                console.log('üì¶ Supabase Antwort:', data);
                
                if (data[0]) {
                    const lead = data[0];
                    const answers = lead.answers || {};
                    
                    console.log('üìã Answers:', answers);
                    
                    // Alle Daten in localStorage speichern
                    if (answers.dog_name) localStorage.setItem('dogName', answers.dog_name);
                    if (answers.dog_age) localStorage.setItem('dogAge', answers.dog_age);
                    if (answers.dog_breed) localStorage.setItem('dogBreed', answers.dog_breed);
                    if (answers.dog_gender) localStorage.setItem('dogGender', answers.dog_gender);
                    if (answers.dog_goal) localStorage.setItem('dogGoal', answers.dog_goal);
                    if (answers.dog_problem) localStorage.setItem('dogProblem', answers.dog_problem);
                    if (answers.dog_behaviors) localStorage.setItem('dogBehaviors', JSON.stringify(answers.dog_behaviors));
                    if (answers.had_training) localStorage.setItem('hadTraining', answers.had_training);
                    if (answers.territorial_aggression) localStorage.setItem('territorialAggression', answers.territorial_aggression);
                    if (lead.email) localStorage.setItem('userEmail', lead.email);
                    
                    // Lead ID speichern
                    localStorage.setItem('leadId', lead.id);
                    
                    console.log('‚úÖ Daten aus Supabase geladen, reload...');
                    
                    // Seite neu laden ohne Parameter (um Loop zu vermeiden)
                    window.location.href = window.location.pathname;
                    return;
                } else {
                    console.log('‚ö†Ô∏è Keine Daten gefunden f√ºr:', leadIdFromUrl || emailFromUrl);
                }
            } else {
                console.error('‚ùå Supabase response nicht ok:', response.status);
            }
        } catch (error) {
            console.error('‚ùå Supabase load error:', error);
        }
    }
})();

const dogName = localStorage.getItem('dogName') || 'deinen Hund';
const dogProblem = localStorage.getItem('dogProblem') || '';
const dogGoal = localStorage.getItem('dogGoal') || 'obedience';
const userEmailStored = localStorage.getItem('userEmail') || '';

document.getElementById('dogName1').textContent = dogName;
document.getElementById('dogName2').textContent = dogName;
document.getElementById('dogName3').textContent = dogName;
document.getElementById('dogName4').textContent = dogName;
if(document.getElementById('dogName5')) document.getElementById('dogName5').textContent = dogName;
if(document.getElementById('dogName6')) document.getElementById('dogName6').textContent = dogName;
if(document.getElementById('dogNamePlan')) document.getElementById('dogNamePlan').textContent = dogName;
document.getElementById('checkoutDogName').textContent = dogName;
if(document.getElementById('checkoutDogName2')) document.getElementById('checkoutDogName2').textContent = dogName;

// Goal Mapping
const goalMap = {
    'basics': 'Grundlagen lernen',
    'obedience': 'Gehorsam verbessern',
    'commands': 'Kommandos beibringen',
    'bond': 'Bindung st√§rken',
    'behavior': 'Verhalten verbessern',
    'anxiety': '√Ñngste abbauen',
    'potty': 'Toiletten-Routine',
    'none': 'Allgemeines Training'
};
if(document.getElementById('userGoal')) document.getElementById('userGoal').textContent = goalMap[dogGoal] || 'Erste Erfolge sehen';

const problemMap = {'pulling':'Leinenziehen','barking':'√úberm√§√üiges Bellen','aggression':'Aggression','anxiety':'Trennungsangst','jumping':'Anspringen','recall':'Kommt nicht zur√ºck','energy':'√úberm√§√üige Energie','destructive':'Zerst√∂rerisches Verhalten','soiling':'In die Wohnung machen'};
const problemText = problemMap[dogProblem] || 'Verhaltensproblem';
document.getElementById('userProblem').textContent = problemText;
if(document.getElementById('userProblemBenefit')) document.getElementById('userProblemBenefit').textContent = problemText;
if(document.getElementById('userProblemBenefit2')) document.getElementById('userProblemBenefit2').textContent = problemText;
document.getElementById('problemLabel1').textContent = problemText;
document.getElementById('problemLabel2').textContent = problemText;

const problemValueMap = {'pulling':{bad:'Stark',good:'Besser'},'barking':{bad:'H√§ufig',good:'Ruhiger'},'aggression':{bad:'Kritisch',good:'Ruhiger'},'anxiety':{bad:'Stark',good:'Besser'},'jumping':{bad:'St√§ndig',good:'Weniger'},'recall':{bad:'Ignoriert',good:'Besser'},'energy':{bad:'√úberm√§√üig',good:'Ruhiger'},'destructive':{bad:'H√§ufig',good:'Weniger'},'soiling':{bad:'Regelm√§√üig',good:'Seltener'}};
const values = problemValueMap[dogProblem] || {bad:'Kritisch',good:'Besser'};
document.getElementById('problemValue1').textContent = values.bad;
document.getElementById('problemValue2').textContent = values.good;
if (userEmailStored) document.getElementById('checkoutEmailInput').value = userEmailStored;

function startCountdown() {
    let endTime = localStorage.getItem('schnellstart_countdown');
    if (!endTime) { endTime = Date.now() + (24 * 60 * 60 * 1000); localStorage.setItem('schnellstart_countdown', endTime); }
    endTime = parseInt(endTime);
    function update() {
        const diff = endTime - Date.now();
        if (diff <= 0) { document.getElementById('timer').textContent = 'ABGELAUFEN'; return; }
        const h = Math.floor(diff / 3600000), m = Math.floor((diff % 3600000) / 60000), s = Math.floor((diff % 60000) / 1000);
        document.getElementById('timer').textContent = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        setTimeout(update, 1000);
    }
    update();
}
startCountdown();

let tpCurrentSlide = 0;
const tpTrack = document.getElementById('tpTrack'), tpDots = document.querySelectorAll('.tp-dot');
function goToTpSlide(index) { tpCurrentSlide = index; tpTrack.style.transform = `translateX(-${index * 100}%)`; tpDots.forEach((dot, i) => dot.classList.toggle('active', i === index)); }
tpDots.forEach(dot => dot.addEventListener('click', () => goToTpSlide(parseInt(dot.dataset.index))));
setInterval(() => { tpCurrentSlide = (tpCurrentSlide + 1) % 3; goToTpSlide(tpCurrentSlide); }, 4000);

let stripe = null, elements = null, paymentElement = null, currentLeadId = localStorage.getItem('leadId') || null, userEmail = null;
function getCookie(name) { const value = `; ${document.cookie}`; const parts = value.split(`; ${name}=`); if (parts.length === 2) return parts.pop().split(';').shift(); return null; }
function generateEventId() { return 'evt_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9); }

function parseJSON(str) {
    try { return JSON.parse(str || '[]'); } catch(e) { return []; }
}

async function saveToSupabase() {
    const existingLeadId = localStorage.getItem('leadId');
    const urlParams = new URLSearchParams(window.location.search);
    
    // Facebook Browser ID und Click ID
    const fbp = getCookie('_fbp') || null;
    const fbclid = urlParams.get('fbclid') || localStorage.getItem('fbclid') || null;
    const fbc = getCookie('_fbc') || (fbclid ? 'fb.1.' + Date.now() + '.' + fbclid : null);
    const fb_event_id = generateEventId();
    localStorage.setItem('fb_event_id', fb_event_id);
    
    const utmParams = {
        utm_source: urlParams.get('utm_source') || localStorage.getItem('utm_source') || null,
        utm_medium: urlParams.get('utm_medium') || localStorage.getItem('utm_medium') || null,
        utm_campaign: urlParams.get('utm_campaign') || localStorage.getItem('utm_campaign') || null,
        utm_content: urlParams.get('utm_content') || localStorage.getItem('utm_content') || null,
        utm_term: urlParams.get('utm_term') || localStorage.getItem('utm_term') || null,
        fbclid: fbclid,
        fbp: fbp,
        fbc: fbc,
        fb_event_id: fb_event_id,
        gclid: urlParams.get('gclid') || localStorage.getItem('gclid') || null,
        ttclid: urlParams.get('ttclid') || localStorage.getItem('ttclid') || null
    };

    const answers = {
        dog_name: localStorage.getItem('dogName'),
        dog_age: localStorage.getItem('dogAge'),
        dog_breed: localStorage.getItem('dogBreed'),
        dog_gender: localStorage.getItem('dogGender'),
        dog_goal: localStorage.getItem('dogGoal'),
        dog_problem: localStorage.getItem('dogProblem'),
        dog_behaviors: parseJSON(localStorage.getItem('dogBehaviors')),
        had_training: localStorage.getItem('hadTraining'),
        territorial_aggression: localStorage.getItem('territorialAggression'),
        email: userEmail || localStorage.getItem('userEmail') || null,
        ...utmParams
    };

    localStorage.setItem('wauwerk_answers', JSON.stringify(answers));

    // WENN LEAD EXISTIERT: UPDATE STATT INSERT
    if (existingLeadId) {
        console.log('üìù Updating existing lead for schnellstart:', existingLeadId);
        try {
            const response = await fetch(SUPABASE_URL + '/rest/v1/wauwerk_leads?id=eq.' + existingLeadId, {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json',
                    'apikey': SUPABASE_ANON_KEY,
                    'Authorization': 'Bearer ' + SUPABASE_ANON_KEY,
                    'Prefer': 'return=representation'
                },
                body: JSON.stringify({
                    selected_plan: 'schnellstart',
                    price: '‚Ç¨9,99',
                    status: 'pending',
                    answers: answers
                })
            });
            
            if (response.ok) {
                console.log('‚úÖ Lead updated to schnellstart pending:', existingLeadId);
                return existingLeadId;
            }
        } catch (error) {
            console.error('‚ùå Update error:', error);
        }
        return existingLeadId;
    }

    // FALLBACK: NEUEN LEAD ERSTELLEN
    const leadData = {
        dog_name: localStorage.getItem('dogName'),
        selected_plan: 'schnellstart',
        price: '‚Ç¨9,99',
        status: 'pending',
        answers: answers,
        email: userEmail || localStorage.getItem('userEmail') || null
    };

    console.log('üìù Creating new schnellstart lead');
    try {
        const response = await fetch(SUPABASE_URL + '/rest/v1/wauwerk_leads', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': 'Bearer ' + SUPABASE_ANON_KEY,
                'Prefer': 'return=representation'
            },
            body: JSON.stringify(leadData)
        });
        
        if (!response.ok) {
            console.error('Supabase error:', response.status);
            return null;
        }
        
        const data = await response.json();
        const newId = data[0]?.id || null;
        if (newId) localStorage.setItem('leadId', newId);
        return newId;
    } catch (error) {
        console.error('Failed to save lead:', error);
        return null;
    }
}

// submitEmail nicht mehr ben√∂tigt - Email kommt via Brevo-Link

async function openCheckoutPopup() {
    if (!currentLeadId) currentLeadId = await saveToSupabase();
    
    // Problem-Label setzen
    const checkoutDogProblem = document.getElementById('checkoutDogProblem');
    if (checkoutDogProblem) checkoutDogProblem.textContent = problemText;
    
    // Direkt zu Zahlung (Email bereits bekannt aus Brevo)
    document.getElementById('checkoutStepEmail').classList.add('hidden');
    document.getElementById('checkoutStep1').classList.add('hidden');
    document.getElementById('checkoutStep2').classList.add('active');
    
    document.getElementById('checkoutPopup').classList.add('active');
    document.body.style.overflow = 'hidden';
    
    // Direkt Stripe laden
    goToPaymentStep();
}

function closeCheckoutPopup() { document.getElementById('checkoutPopup').classList.remove('active'); document.body.style.overflow = ''; }

async function goToPaymentStep() {
    document.getElementById('checkoutStepEmail').classList.add('hidden');
    document.getElementById('checkoutStep1').classList.add('hidden');
    document.getElementById('checkoutStep2').classList.add('active');
    
    // Email aus localStorage (kam √ºber Brevo-Link)
    userEmail = localStorage.getItem('userEmail') || '';
    
    if (!stripe) stripe = Stripe(STRIPE_PUBLIC_KEY);
    try {
        const response = await fetch('/api/wauwerk-checkout', { 
            method: 'POST', 
            headers: {'Content-Type':'application/json'}, 
            body: JSON.stringify({ 
                plan: 'schnellstart', 
                timerExpired: false, 
                dogName: dogName, 
                leadId: currentLeadId, 
                email: userEmail,
                utm_source: localStorage.getItem('utm_source') || '',
                utm_medium: localStorage.getItem('utm_medium') || '',
                utm_campaign: localStorage.getItem('utm_campaign') || '',
                utm_content: localStorage.getItem('utm_content') || '',
                fbclid: localStorage.getItem('fbclid') || '',
                fbp: getCookie('_fbp') || '', 
                fbc: getCookie('_fbc') || '',
                fb_event_id: localStorage.getItem('fb_event_id') || '',
                ttclid: localStorage.getItem('ttclid') || ''
            }) 
        });
        const data = await response.json();
        if (data.error) { showCheckoutError(data.error); return; }
        
        // Event ID in answers updaten
        if (currentLeadId && data.paymentIntentId) {
            const currentAnswers = JSON.parse(localStorage.getItem('wauwerk_answers') || '{}');
            currentAnswers.event_id = data.paymentIntentId;
            currentAnswers.fb_event_id = localStorage.getItem('fb_event_id') || '';
            
            fetch(SUPABASE_URL + '/rest/v1/wauwerk_leads?id=eq.' + currentLeadId, {
                method: 'PATCH',
                headers: {
                    'apikey': SUPABASE_ANON_KEY,
                    'Authorization': 'Bearer ' + SUPABASE_ANON_KEY,
                    'Content-Type': 'application/json',
                    'Prefer': 'return=minimal'
                },
                body: JSON.stringify({ answers: currentAnswers })
            });
            
            localStorage.setItem('wauwerk_answers', JSON.stringify(currentAnswers));
        }
        
        elements = stripe.elements({clientSecret: data.clientSecret, appearance: {theme:'stripe',variables:{colorPrimary:'#C4A576',borderRadius:'8px'}}, locale:'de'});
        paymentElement = elements.create('payment', {layout:{type:'tabs',defaultCollapsed:false}, paymentMethodOrder:['klarna','paypal','card'], wallets: {applePay:'auto', googlePay:'auto'}});
        paymentElement.mount('#payment-element');
    } catch (error) { showCheckoutError('Verbindungsfehler.'); }
}

function goBackToStep1() { closeCheckoutPopup(); }

async function submitPayment() {
    const payBtn = document.getElementById('checkoutPayBtn');
    payBtn.disabled = true; payBtn.innerHTML = '<span class="spinner"></span> Wird verarbeitet...';
    hideCheckoutError();
    try {
        const { error } = await stripe.confirmPayment({ elements, confirmParams: { return_url: window.location.origin + '/danke.html?lead_id=' + currentLeadId } });
        if (error) { showCheckoutError(error.message); payBtn.disabled = false; payBtn.innerHTML = 'üîí Jetzt ‚Ç¨9,99 bezahlen'; }
    } catch (err) { showCheckoutError('Zahlung fehlgeschlagen.'); payBtn.disabled = false; payBtn.innerHTML = 'üîí Jetzt ‚Ç¨9,99 bezahlen'; }
}

function showCheckoutError(message) { const el = document.getElementById('checkoutError'); el.textContent = message; el.classList.add('visible'); }
function hideCheckoutError() { document.getElementById('checkoutError').classList.remove('visible'); }
async function getMyPlan() { openCheckoutPopup(); }
</script>
</body>
</html>