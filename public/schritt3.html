<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–∞–≥ 2: –°–µ–º—å—è –∏ –≤—ä–µ–∑–¥</title>

    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "u1bdqt1zrn");
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Inter", -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            color: #2D3748;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        .progress-container {
            background: white;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .progress-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e3c72;
        }

        .progress-step {
            background: #f0f9ff;
            color: #1e3c72;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            height: 100%;
            width: 67%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .form-container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
        }

        h1 {
            font-size: 28px;
            color: #1a202c;
            margin-bottom: 10px;
            font-weight: 700;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            color: #4a5568;
            font-size: 16px;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .form-section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-info {
            color: #718096;
            font-size: 13px;
            margin-bottom: 15px;
            font-style: italic;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
            font-size: 14px;
        }

        .required {
            color: #e53e3e;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s ease;
            background: #ffffff;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #1e3c72;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .help-text {
            font-size: 12px;
            color: #718096;
            margin-top: 4px;
            font-style: italic;
        }

        .next-button {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .next-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 60, 114, 0.3);
        }

        .security-note {
            text-align: center;
            color: #718096;
            font-size: 12px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .error-message {
            color: #e53e3e;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .form-group.error input,
        .form-group.error select {
            border-color: #e53e3e;
        }

        .form-group.error .error-message {
            display: block;
        }

        .back-button {
            background: none;
            color: #718096;
            border: 1px solid #e2e8f0;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
            margin-bottom: 20px;
        }

        .back-button:hover {
            border-color: #cbd5e0;
            background: #f7fafc;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .form-container {
                padding: 25px 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            h1 {
                font-size: 24px;
            }

            .subtitle {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Progress -->
        <div class="progress-container">
            <div class="progress-header">
                <div class="progress-title">–°–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞—è–≤–ª–µ–Ω–∏–π –ø–æ ¬ß24</div>
                <div class="progress-step">–®–∞–≥ 2 –∏–∑ 3</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>

        <!-- Form -->
        <div class="form-container">
            <a href="/schritt2.html" class="back-button">‚Üê –ù–∞–∑–∞–¥ –∫ —à–∞–≥—É 1</a>
            
            <h1>–°–µ–º—å—è –∏ –≤—ä–µ–∑–¥</h1>
            <p class="subtitle">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—à–µ–π —Å–µ–º—å–µ –∏ –ø—É—Ç–∏ –≤ –ì–µ—Ä–º–∞–Ω–∏—é</p>

            <form id="familyDataForm">
                <!-- Familie -->
                <div class="form-section">
                    <div class="section-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ 4. –ß–ª–µ–Ω—ã —Å–µ–º—å–∏</div>
                    <p class="section-info">–≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º —Å —Å–µ–º–µ–π–Ω—ã–º–∏ –ø–æ—Å–æ–±–∏—è–º–∏ –∏ –∑–∞—è–≤–ª–µ–Ω–∏—è–º–∏ –Ω–∞ –¥–µ—Ç—Å–∫–∏–µ –¥–µ–Ω—å–≥–∏</p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ehepartner_vorhanden">–ï—Å—Ç—å –ª–∏ —Å—É–ø—Ä—É–≥(–∞)? <span class="required">*</span></label>
                            <select id="ehepartner_vorhanden" name="ehepartner_vorhanden" required onchange="toggleEhepartnerFields()">
                                <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                                <option value="ja">–î–∞</option>
                                <option value="nein">–ù–µ—Ç</option>
                            </select>
                            <div class="error-message">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é</div>
                        </div>
                        <div class="form-group" id="ehepartner_name_group" style="display: none;">
                            <label for="ehepartner_name">–ò–º—è —Å—É–ø—Ä—É–≥–∞(–∏)</label>
                            <input type="text" id="ehepartner_name" name="ehepartner_name" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="kinder_vorhanden">–ï—Å—Ç—å –ª–∏ –¥–µ—Ç–∏? <span class="required">*</span></label>
                            <select id="kinder_vorhanden" name="kinder_vorhanden" required onchange="toggleKinderFields()">
                                <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                                <option value="ja">–î–∞</option>
                                <option value="nein">–ù–µ—Ç</option>
                            </select>
                            <div class="error-message">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é</div>
                        </div>
                        <div class="form-group" id="kinder_details_group" style="display: none;">
                            <label for="kinder_namen_alter">–ò–º–µ–Ω–∞ –∏ –≤–æ–∑—Ä–∞—Å—Ç –¥–µ—Ç–µ–π</label>
                            <input type="text" id="kinder_namen_alter" name="kinder_namen_alter" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, –ú–∞—Ä–∏—è, 7 / –ù–∏–∫–∏—Ç–∞, 3">
                            <div class="help-text">–§–æ—Ä–º–∞—Ç: –ò–º—è, –í–æ–∑—Ä–∞—Å—Ç / –ò–º—è, –í–æ–∑—Ä–∞—Å—Ç</div>
                        </div>
                    </div>
                </div>

                <!-- Einreise -->
                <div class="form-section">
                    <div class="section-title">‚úàÔ∏è 5. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ä–µ–∑–¥–µ</div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="einreisedatum">–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –¥–∞—Ç–∞ –≤—ä–µ–∑–¥–∞ –≤ –ì–µ—Ä–º–∞–Ω–∏—é <span class="required">*</span></label>
                            <input type="date" id="einreisedatum" name="einreisedatum" required>
                            <div class="error-message">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –ø–ª–∞–Ω–∏—Ä—É–µ–º—É—é –¥–∞—Ç—É –≤—ä–µ–∑–¥–∞</div>
                        </div>
                        <div class="form-group">
                            <label for="einreiseweg">–ü—É—Ç—å –≤—ä–µ–∑–¥–∞ <span class="required">*</span></label>
                            <select id="einreiseweg" name="einreiseweg" required>
                                <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                                <option value="polen">—á–µ—Ä–µ–∑ –ü–æ–ª—å—à—É</option>
                                <option value="rumaenien">—á–µ—Ä–µ–∑ –†—É–º—ã–Ω–∏—é</option>
                                <option value="slowakei">—á–µ—Ä–µ–∑ –°–ª–æ–≤–∞–∫–∏—é</option>
                                <option value="andere">–¥—Ä—É–≥–æ–π –º–∞—Ä—à—Ä—É—Ç</option>
                            </select>
                            <div class="error-message">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—É—Ç—å –≤—ä–µ–∑–¥–∞</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="reiseart">–°–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è</label>
                            <select id="reiseart" name="reiseart">
                                <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                                <option value="bus">–ê–≤—Ç–æ–±—É—Å</option>
                                <option value="zug">–ü–æ–µ–∑–¥</option>
                                <option value="auto">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</option>
                                <option value="andere">–¥—Ä—É–≥–æ–µ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="familie_allein">–ü—É—Ç–µ—à–µ—Å—Ç–≤—É–µ—Ç–µ –æ–¥–Ω–∏ –∏–ª–∏ —Å —Å–µ–º—å–µ–π? <span class="required">*</span></label>
                            <select id="familie_allein" name="familie_allein" required>
                                <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                                <option value="familie">—Å —Å–µ–º—å–µ–π</option>
                                <option value="allein">–æ–¥–∏–Ω(–Ω–∞)</option>
                            </select>
                            <div class="error-message">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é</div>
                        </div>
                    </div>
                </div>

                <!-- Unterkunft -->
                <div class="form-section">
                    <div class="section-title">üè† 6. –ñ–∏–ª—å–µ / –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–µ –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ –≤ –ì–µ—Ä–º–∞–Ω–∏–∏</div>
                    
                    <div class="form-group">
                        <label for="unterkunft_vorhanden">–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å —É–∂–µ –∂–∏–ª—å–µ –≤ –ì–µ—Ä–º–∞–Ω–∏–∏? <span class="required">*</span></label>
                        <select id="unterkunft_vorhanden" name="unterkunft_vorhanden" required onchange="toggleUnterkunftFields()">
                            <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                            <option value="ja">–î–∞</option>
                            <option value="nein">–ù–µ—Ç</option>
                        </select>
                        <div class="error-message">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é</div>
                    </div>

                    <div id="wunsch_stadt_field" style="display: none;">
                        <div class="form-group">
                            <label for="wunsch_stadt">–í –∫–∞–∫–æ–π –≥–æ—Ä–æ–¥ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–µ—Ö–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞? <span class="required">*</span></label>
                            <select id="wunsch_stadt" name="wunsch_stadt">
                                <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                                <option value="berlin">–ë–µ—Ä–ª–∏–Ω</option>
                                <option value="hamburg">–ì–∞–º–±—É—Ä–≥</option>
                                <option value="muenchen">–ú—é–Ω—Ö–µ–Ω</option>
                                <option value="koeln">–ö–µ–ª—å–Ω</option>
                                <option value="frankfurt">–§—Ä–∞–Ω–∫—Ñ—É—Ä—Ç</option>
                                <option value="stuttgart">–®—Ç—É—Ç–≥–∞—Ä—Ç</option>
                                <option value="duesseldorf">–î—é—Å—Å–µ–ª—å–¥–æ—Ä—Ñ</option>
                                <option value="andere">–¥—Ä—É–≥–æ–π –≥–æ—Ä–æ–¥</option>
                            </select>
                            <div class="error-message">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</div>
                        </div>
                    </div>

                    <div id="adresse_field" style="display: none;">
                        <div class="form-group">
                            <label for="adresse">–ï—Å–ª–∏ –¥–∞: –ê–¥—Ä–µ—Å (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω)</label>
                            <input type="text" id="adresse" name="adresse" placeholder="—É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è 12, –ë–µ—Ä–ª–∏–Ω">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="verwandte_freunde">–ï—Å—Ç—å –ª–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ / –¥—Ä—É–∑—å—è –≤ –ì–µ—Ä–º–∞–Ω–∏–∏?</label>
                        <select id="verwandte_freunde" name="verwandte_freunde">
                            <option value="">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ</option>
                            <option value="ja">–î–∞</option>
                            <option value="nein">–ù–µ—Ç</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="next-button">–ü–µ—Ä–µ–π—Ç–∏ –∫ —à–∞–≥—É 3 ‚Üí</button>

                <div class="security-note">
                    üîí –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ
                </div>
            </form>
        </div>
    </div>

    <script>
        // Form validation and submission
        document.getElementById('familyDataForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate form
            if (!validateForm()) {
                return;
            }
            
            // Save form data
            const formData = new FormData(this);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            localStorage.setItem('familyData', JSON.stringify(data));
            console.log('=== –®–ê–ì 2 –ó–ê–í–ï–†–®–ï–ù ===', data);
            
            // Redirect to step 3
            setTimeout(() => {
                window.location.href = '/schritt4.html';
            }, 200);
        });

        function validateForm() {
            let isValid = true;
            
            // Remove previous error states
            document.querySelectorAll('.form-group').forEach(group => {
                group.classList.remove('error');
            });
            
            // Check required fields
            const requiredFields = ['ehepartner_vorhanden', 'kinder_vorhanden', 'einreisedatum', 'einreiseweg', 'familie_allein', 'unterkunft_vorhanden'];
            
            // Conditional required fields
            const unterkunftVorhanden = document.getElementById('unterkunft_vorhanden').value;
            if (unterkunftVorhanden === 'nein') {
                requiredFields.push('wunsch_stadt');
            }
            
            requiredFields.forEach(fieldName => {
                const field = document.getElementById(fieldName);
                const group = field?.closest('.form-group');
                
                if (field && !field.value.trim()) {
                    group?.classList.add('error');
                    isValid = false;
                }
            });
            
            return isValid;
        }

        // Toggle functions for dynamic fields
        function toggleEhepartnerFields() {
            const value = document.getElementById('ehepartner_vorhanden').value;
            const nameGroup = document.getElementById('ehepartner_name_group');
            if (value === 'ja') {
                nameGroup.style.display = 'block';
            } else {
                nameGroup.style.display = 'none';
                document.getElementById('ehepartner_name').value = '';
            }
        }

        function toggleKinderFields() {
            const value = document.getElementById('kinder_vorhanden').value;
            const detailsGroup = document.getElementById('kinder_details_group');
            if (value === 'ja') {
                detailsGroup.style.display = 'block';
            } else {
                detailsGroup.style.display = 'none';
                document.getElementById('kinder_namen_alter').value = '';
            }
        }

        function toggleUnterkunftFields() {
            const value = document.getElementById('unterkunft_vorhanden').value;
            const adresseField = document.getElementById('adresse_field');
            const wunschStadtField = document.getElementById('wunsch_stadt_field');
            
            if (value === 'ja') {
                adresseField.style.display = 'block';
                wunschStadtField.style.display = 'none';
                // Reset wunsch_stadt when not needed
                document.getElementById('wunsch_stadt').value = '';
            } else if (value === 'nein') {
                adresseField.style.display = 'none';
                wunschStadtField.style.display = 'block';
                // Reset address when not needed
                document.getElementById('adresse').value = '';
            } else {
                adresseField.style.display = 'none';
                wunschStadtField.style.display = 'none';
            }
        }

        // Auto-save and restore form data
        document.addEventListener('DOMContentLoaded', function() {
            const savedData = localStorage.getItem('familyData');
            if (savedData) {
                const data = JSON.parse(savedData);
                Object.keys(data).forEach(key => {
                    const field = document.getElementById(key);
                    if (field) {
                        field.value = data[key];
                        
                        // Trigger change events for dynamic fields
                        if (key === 'ehepartner_vorhanden') toggleEhepartnerFields();
                        if (key === 'kinder_vorhanden') toggleKinderFields();
                        if (key === 'unterkunft_vorhanden') toggleUnterkunftFields();
                    }
                });
                console.log('=== –°–ï–ú–ï–ô–ù–´–ï –î–ê–ù–ù–´–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–´ ===', data);
            }
        });

        // Auto-save on input
        document.querySelectorAll('input, select').forEach(field => {
            field.addEventListener('input', function() {
                // Remove error state when user starts typing
                this.closest('.form-group').classList.remove('error');
                
                // Auto-save immediately
                saveAllFormData();
            });
        });

        function saveAllFormData() {
            const formData = new FormData(document.getElementById('familyDataForm'));
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            localStorage.setItem('familyData', JSON.stringify(data));
            localStorage.setItem('familyData_timestamp', Date.now());
            console.log('=== –ê–í–¢–û–°–û–•–†–ê–ù–ï–ù–ò–ï –°–ï–ú–ï–ô–ù–´–• –î–ê–ù–ù–´–• ===', data);
        }

        // Save on page unload as backup
        window.addEventListener('beforeunload', function() {
            saveAllFormData();
        });
    </script>
</body>
</html>